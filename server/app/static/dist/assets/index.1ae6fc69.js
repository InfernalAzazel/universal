import{d as me,a as _e,M as fe,u as he,r as d,N as be,c as U,Q as ve,A as p,e as f,q as h,w as r,O as ye,i as t,G as g,g as o,s as c,t as u,h as m,X as L,L as k,Y as q,n as i,P as ge}from"./index.305d1985.js";import{u as ke}from"./crud.5df62e72.js";const Te={class:"relative w-full h-10"},xe={class:"relative w-full h-10"},we={class:"custom-tree-node"},Re=me({__name:"index",setup(De){const{t:e}=_e(),F=fe({label:e("crud.label"),addText:e("crud.addText"),detailText:e("crud.detailText"),editText:e("crud.editText"),searchText:e("crud.searchText"),searchResetText:e("crud.searchResetText"),submitText:e("crud.submitText"),resetText:e("crud.resetText"),detail:!0,edit:!0,del:!1,searchReset:!0,fixed:"right",width:"300"}),z=he(),T=d(!1),_=d({uid:"",key:"",name_zh_ch:"",name_en_us:"",describe:"",menu_permission:[],interface_permission:[]}),x=d([]),w=d([]),V=be([{label:e("system.role.uid"),prop:"uid",component:"el-input",detail:!0,props:{disabled:!0}},{label:e("system.role.name_zh_cn"),prop:"name_zh_cn",component:"el-input",form:!0,search:!0,detail:!0},{label:e("system.role.name_en_us"),prop:"name_en_us",component:"el-input",form:!0,search:!0,detail:!0},{label:e("system.role.describe"),prop:"describe",component:"el-input",props:{type:"textarea",rows:14,minRows:12,maxRows:24},form:!0,detail:!0},{label:e("el-date-picker.create_at"),prop:"create_at",component:"el-date-picker",props:{type:"datetimerange",rangeSeparator:"-",startPlaceholder:"start",endPlaceholder:"end",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DDTHH:mm:ss"},search:!0,detail:!0},{label:e("el-date-picker.update_at"),prop:"update_at",component:"el-date-picker",props:{type:"datetimerange",rangeSeparator:"-",startPlaceholder:"start",endPlaceholder:"end",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DDTHH:mm:ss"},search:!0,detail:!0}]),D=d(JSON.parse(JSON.stringify(V))),E=d(),P=d({children:"children",label:"title_en_us"}),N=d(),$=d({children:"children",label:"describe_en_us"}),{data:G,execute:H}=U(p.menuAll),{data:I,execute:K}=U(p.interfaceAll),{execute:A}=ve(p.roleEdit,_),B={key:{required:!0,message:e("rules.role.key"),trigger:"blur"},name_zh_cn:{required:!0,message:e("rules.role.name_zh_cn"),trigger:"blur"},name_en_us:{required:!0,message:e("rules.role.name_en_us"),trigger:"blur"},describe:{required:!0,message:e("rules.role.describe"),trigger:"blur"}},{form:Y,serachForm:C,detail:J,loadList:b,currentPage:R,pageSize:M,list:j,total:Q,isFetching:X,beforeOpen:W,submit:Z,search:ee,deleteRow:te}=ke(p.roleList,p.roleAdd,p.roleEdit,p.roleDelete,!0),re=a=>{T.value=!0,_.value=a,P.value.label=z.value.locales==="en-us"?"title_en_us":"title_zh_cn",$.value.label=z.value.locales==="en-us"?"describe_en_us":"describe_zh_cn",H(),x.value=[],_.value.menu_permission.forEach(l=>{x.value.push(l.uid)}),K(),w.value=[],_.value.interface_permission.forEach(l=>{w.value.push(l.uid)})},ae=async()=>{var a;_.value.menu_permission=(a=E.value)==null?void 0:a.getCheckedNodes(),await A(),q.success(e("system.role.permission_ok")),await b()},le=async()=>{var a;_.value.interface_permission=(a=N.value)==null?void 0:a.getCheckedNodes(),await A(),q.success(e("system.role.permission_ok")),await b()};return(a,l)=>{const se=i("pro-column-setting"),v=i("el-button"),oe=i("el-popconfirm"),ne=i("pro-crud"),O=i("el-tab-pane"),S=i("el-divider"),y=i("el-tag"),ue=i("el-tabs"),ie=i("el-drawer"),de=i("pro-card"),ce=ge("loading");return f(),h(de,null,{default:r(()=>[ye((f(),h(ne,{modelValue:t(Y),"onUpdate:modelValue":l[1]||(l[1]=s=>g(Y)?Y.value=s:null),search:t(C),"onUpdate:search":l[2]||(l[2]=s=>g(C)?C.value=s:null),"current-page":t(R),"onUpdate:current-page":l[3]||(l[3]=s=>g(R)?R.value=s:null),"page-size":t(M),"onUpdate:page-size":l[4]||(l[4]=s=>g(M)?M.value=s:null),columns:t(V),menu:t(F),data:t(j),total:t(Q),detail:t(J),"before-open":t(W),onSearch:t(ee),onLoad:t(b),onSearchReset:t(b),onSubmit:t(Z),"table-columns":D.value,rules:B,layout:"total, ->, jumper, prev, pager, next, sizes",border:"",stripe:""},{action:r(()=>[o(se,{modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=s=>D.value=s)},null,8,["modelValue"])]),menu:r(({row:s,size:n})=>[o(oe,{title:a.$t("crud.isDelText"),onConfirm:pe=>t(te)(s)},{reference:r(()=>[o(v,{size:n,type:"danger",link:""},{default:r(()=>[c(u(a.$t("crud.delText")),1)]),_:2},1032,["size"])]),_:2},1032,["title","onConfirm"]),o(v,{size:n,type:"success",link:"",onClick:pe=>re(s)},{default:r(()=>[c(u(a.$t("system.role.set_permissions")),1)]),_:2},1032,["size","onClick"])]),_:1},8,["modelValue","search","current-page","page-size","columns","menu","data","total","detail","before-open","onSearch","onLoad","onSearchReset","onSubmit","table-columns"])),[[ce,t(X)]]),o(ie,{modelValue:T.value,"onUpdate:modelValue":l[5]||(l[5]=s=>T.value=s),direction:"rtl"},{header:r(()=>[m("h2",null,u(a.$t("system.role.set_permissions")),1)]),default:r(()=>[o(ue,{type:"border-card"},{default:r(()=>[o(O,{label:a.$t("system.role.menu_tab_label")},{default:r(()=>[m("div",Te,[o(v,{class:"absolute top-0 right-0",type:"primary",onClick:ae},{default:r(()=>[c(u(a.$t("system.role.permission_btu")),1)]),_:1})]),o(t(L),{ref_key:"menuTreeRef",ref:E,data:t(G),"show-checkbox":"","default-checked-keys":x.value,"node-key":"uid",props:P.value},null,8,["data","default-checked-keys","props"])]),_:1},8,["label"]),o(O,{label:a.$t("system.role.interface_tab_label")},{default:r(()=>[m("div",xe,[o(v,{class:"absolute top-0 right-0",type:"primary",onClick:le},{default:r(()=>[c(u(a.$t("system.role.permission_btu")),1)]),_:1})]),o(t(L),{ref_key:"interfaceTreeRef",ref:N,data:t(I),"show-checkbox":"","default-checked-keys":w.value,"node-key":"uid",props:$.value},{default:r(({node:s,data:n})=>[m("span",we,[m("span",null,u(s.label),1),o(S,{direction:"vertical"}),m("span",null,u(n.group),1),o(S,{direction:"vertical"}),n.method==="GET"?(f(),h(y,{key:0,type:""},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),n.method==="POST"?(f(),h(y,{key:1,type:"success"},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),n.method==="PUT"?(f(),h(y,{key:2,type:"warning"},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),n.method==="DELETE"?(f(),h(y,{key:3,type:"danger"},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),o(S,{direction:"vertical"}),m("span",null,u(n.path),1)])]),_:1},8,["data","default-checked-keys","props"])]),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{Re as default};
