import{d as me,b as _e,Q as fe,u as he,r as d,R as be,g as O,D as ve,A as p,h as f,z as h,w as r,S as ye,n as t,l as g,j as o,B as c,t as u,k as m,_ as L,P as k,$ as q,v as i,U as ge}from"./index.90662b97.js";import{u as ke}from"./crud.6c5008af.js";const Te={class:"relative w-full h-10"},xe={class:"relative w-full h-10"},we={class:"custom-tree-node"},Ye=me({__name:"index",setup(Ce){const{t:e}=_e(),B=fe({label:e("crud.label"),addText:e("crud.addText"),detailText:e("crud.detailText"),editText:e("crud.editText"),searchText:e("crud.searchText"),searchResetText:e("crud.searchResetText"),submitText:e("crud.submitText"),resetText:e("crud.resetText"),detail:!0,edit:!0,del:!1,searchReset:!0,fixed:"right",width:"300"}),M=he(),T=d(!1),_=d({id:"",key:"",name_zh_ch:"",name_en_us:"",describe:"",menu_permission:[],interface_permission:[]}),x=d([]),w=d([]),V=be([{label:e("system.role.id"),prop:"id",component:"el-input",detail:!0,props:{disabled:!0}},{label:e("system.role.name_zh_cn"),prop:"name_zh_cn",component:"el-input",form:!0,search:!0,detail:!0},{label:e("system.role.name_en_us"),prop:"name_en_us",component:"el-input",form:!0,search:!0,detail:!0},{label:e("system.role.describe"),prop:"describe",component:"el-input",props:{type:"textarea",rows:14,minRows:12,maxRows:24},form:!0,detail:!0},{label:e("el-date-picker.create_at"),prop:"create_at",component:"el-date-picker",props:{type:"datetimerange",rangeSeparator:"-",startPlaceholder:"start",endPlaceholder:"end",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DDTHH:mm:ss"},search:!0,detail:!0},{label:e("el-date-picker.update_at"),prop:"update_at",component:"el-date-picker",props:{type:"datetimerange",rangeSeparator:"-",startPlaceholder:"start",endPlaceholder:"end",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DDTHH:mm:ss"},search:!0,detail:!0}]),C=d(JSON.parse(JSON.stringify(V))),E=d(),P=d({children:"children",label:"title_en_us"}),$=d(),N=d({children:"children",label:"describe_en_us"}),{data:F,execute:H}=O(p.menuAll),{data:K,execute:G}=O(p.interfaceAll),{execute:U}=ve(p.roleEdit,_),I={key:{required:!0,message:e("rules.role.key"),trigger:"blur"},name_zh_cn:{required:!0,message:e("rules.role.name_zh_cn"),trigger:"blur"},name_en_us:{required:!0,message:e("rules.role.name_en_us"),trigger:"blur"},describe:{required:!0,message:e("rules.role.describe"),trigger:"blur"}},{form:D,serachForm:R,detail:j,loadList:b,currentPage:Y,pageSize:S,list:J,total:Q,isFetching:W,beforeOpen:X,submit:Z,search:ee,deleteRow:te}=ke(p.roleList,p.roleAdd,p.roleEdit,p.roleDelete,!0),re=a=>{T.value=!0,_.value=a,P.value.label=M.value.locales==="en-us"?"title_en_us":"title_zh_cn",N.value.label=M.value.locales==="en-us"?"describe_en_us":"describe_zh_cn",H(),x.value=[],_.value.menu_permission.forEach(l=>{x.value.push(l.id)}),G(),w.value=[],_.value.interface_permission.forEach(l=>{w.value.push(l.id)})},ae=async()=>{var a;_.value.menu_permission=(a=E.value)==null?void 0:a.getCheckedNodes(),await U(),q.success(e("system.role.permission_ok")),await b()},le=async()=>{var a;_.value.interface_permission=(a=$.value)==null?void 0:a.getCheckedNodes(),await U(),q.success(e("system.role.permission_ok")),await b()};return(a,l)=>{const se=i("pro-column-setting"),v=i("el-button"),oe=i("el-popconfirm"),ne=i("pro-crud"),A=i("el-tab-pane"),z=i("el-divider"),y=i("el-tag"),ue=i("el-tabs"),ie=i("el-drawer"),de=i("pro-card"),ce=ge("loading");return f(),h(de,null,{default:r(()=>[ye((f(),h(ne,{modelValue:t(D),"onUpdate:modelValue":l[1]||(l[1]=s=>g(D)?D.value=s:null),search:t(R),"onUpdate:search":l[2]||(l[2]=s=>g(R)?R.value=s:null),"current-page":t(Y),"onUpdate:current-page":l[3]||(l[3]=s=>g(Y)?Y.value=s:null),"page-size":t(S),"onUpdate:page-size":l[4]||(l[4]=s=>g(S)?S.value=s:null),columns:t(V),menu:t(B),data:t(J),total:t(Q),detail:t(j),"before-open":t(X),onSearch:t(ee),onLoad:t(b),onSearchReset:t(b),onSubmit:t(Z),"table-columns":C.value,rules:I,layout:"total, ->, jumper, prev, pager, next, sizes",border:"",stripe:""},{action:r(()=>[o(se,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=s=>C.value=s)},null,8,["modelValue"])]),menu:r(({row:s,size:n})=>[o(oe,{title:a.$t("crud.isDelText"),onConfirm:pe=>t(te)(s)},{reference:r(()=>[o(v,{size:n,type:"danger",link:""},{default:r(()=>[c(u(a.$t("crud.delText")),1)]),_:2},1032,["size"])]),_:2},1032,["title","onConfirm"]),o(v,{size:n,type:"success",link:"",onClick:pe=>re(s)},{default:r(()=>[c(u(a.$t("system.role.set_permissions")),1)]),_:2},1032,["size","onClick"])]),_:1},8,["modelValue","search","current-page","page-size","columns","menu","data","total","detail","before-open","onSearch","onLoad","onSearchReset","onSubmit","table-columns"])),[[ce,t(W)]]),o(ie,{modelValue:T.value,"onUpdate:modelValue":l[5]||(l[5]=s=>T.value=s),direction:"rtl"},{header:r(()=>[m("h2",null,u(a.$t("system.role.set_permissions")),1)]),default:r(()=>[o(ue,{type:"border-card"},{default:r(()=>[o(A,{label:a.$t("system.role.menu_tab_label")},{default:r(()=>[m("div",Te,[o(v,{class:"absolute top-0 right-0",type:"primary",onClick:ae},{default:r(()=>[c(u(a.$t("system.role.permission_btu")),1)]),_:1})]),o(t(L),{ref_key:"menuTreeRef",ref:E,data:t(F),"show-checkbox":"","default-checked-keys":x.value,"node-key":"id",props:P.value},null,8,["data","default-checked-keys","props"])]),_:1},8,["label"]),o(A,{label:a.$t("system.role.interface_tab_label")},{default:r(()=>[m("div",xe,[o(v,{class:"absolute top-0 right-0",type:"primary",onClick:le},{default:r(()=>[c(u(a.$t("system.role.permission_btu")),1)]),_:1})]),o(t(L),{ref_key:"interfaceTreeRef",ref:$,data:t(K),"show-checkbox":"","default-checked-keys":w.value,"node-key":"id",props:N.value},{default:r(({node:s,data:n})=>[m("span",we,[m("span",null,u(s.label),1),o(z,{direction:"vertical"}),m("span",null,u(n.group),1),o(z,{direction:"vertical"}),n.method==="GET"?(f(),h(y,{key:0,type:""},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),n.method==="POST"?(f(),h(y,{key:1,type:"success"},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),n.method==="PUT"?(f(),h(y,{key:2,type:"warning"},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),n.method==="DELETE"?(f(),h(y,{key:3,type:"danger"},{default:r(()=>[c(u(n.method),1)]),_:2},1024)):k("",!0),o(z,{direction:"vertical"}),m("span",null,u(n.path),1)])]),_:1},8,["data","default-checked-keys","props"])]),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{Ye as default};
